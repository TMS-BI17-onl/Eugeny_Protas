1. 
SELECT E2.FIRST_NAME, E2.LAST_NAME, COUNT(E1.EMPLOYEE_ID) AS cnt
FROM EMPLOYEES E1 RIGHT JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.MANAGER_ID
GROUP BY E2.FIRST_NAME, E2.LAST_NAME
HAVING COUNT(E1.EMPLOYEE_ID) > 6

2. 
SELECT d.DEPARTMENT_NAME, MIN (e.SALARY*(1-e.COMISSION_PCT/100)) AS min_sal, MAX(e.SALARY*(1-e.COMISSION_PCT/100)) AS max_sal
FROM DEPARTMENTS d LEFT JOIN EMPLOYEES e ON d.DEPARTMENT_ID = e.DEPARTMENT_ID
GROUP BY d.DEPARTMENT_NAME

3.
SELECT TOP 1 WITH TIES r.REGION_NAME 
FROM (SELECT r.REGION_NAME, COUNT(e.DimEmployee) AS cnt
FROM	REGIONS r JOIN COUNTRIES c ON r.REGION_ID = c.REGION_ID
		JOIN LOCATIONS l ON c.COUNTRY_ID = l.COUNTRY_ID
		JOIN DEPARTMENTS d ON l.LOCATION_ID = d.LOCATION_ID
		JOIN EMPLOYEES e ON d.MANAGER_ID = e.EMPLOYEE_ID
GROUP BY r.REGION_NAME
)
ORDER BY cnt DESC

4.
SELECT d.DEPARTMENT_NAME, ((AVG(e.SALARY) OVER (PARTITION BY d.DEPARTMENT_NAME))/(AVG(e.SALARY) OVER ())) * 100 AS 'diff, %'
FROM DEPARTMENTS d LEFT JOIN EMPLOYEES e ON d.DEPARTMENT_ID = e.DEPARTMENT_ID
GROUP BY d.DEPARTMENT_NAME

5.
SELECT e.FIRST_NAME, e.LAST_NAME, d.DEPARTMENT_NAME, DATEDIFF (YEAR, [END_DATE], [START_DATE]) AS Experience
FROM EMPLOYEES e JOIN JOB_HISTORY h ON e.EMPLOYEE_ID=h.EMPLOYEE_ID JOIN DEPARTMENTS d ON h.DEPARTMENT_ID = d.DEPARTMENT_ID
WHERE DATEDIFF (YEAR, [END_DATE], [START_DATE]) > 10

6.
SELECT FIRST_NAME, LAST_NAME
FROM(
SELECT FIRST_NAME, LAST_NAME, DENSE_RANK () OVER (ORDER BY Salary DESC) AS rnk
FROM EMPLOYEES
) rnk_cnt
WHERE rnk BETWEEN 5 AND 10

